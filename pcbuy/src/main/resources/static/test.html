<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

<script>
  jQuery.support.cors = true;
  $(document).ready(function() {

    //第一層選單
    $.ajax({
      url: 'http://localhost:8080/products/CPU/List',
      type: "get",
      dataType: "json",
      success: function (data) {
        // console.log(data);
        $.each(data, function (key, value) { // []->{}*?

          // $('#cpuName').append('<option value="' + key + '">' + data[].productName + '</option>')
          $('#CPU').append('<option value =" '+data[key].productId+' "socket = ' + data[key].socket + '>' + data[key].productName + '</option>')
          // console.log(data[key].productId + " " + data[key].productName + " " + data[key].socket)
        })
      },
      error: function (data) {
        alert("fail");
      }
    });
  });

  function onSelectCPU(){
    var cpuId     = $('#CPU').find(':selected').val()
    var cpuName   = $('#CPU').find(':selected').text()
    var cpuSocket = $('#CPU').find(':selected').attr('socket')
    console.log("cpuId=" + cpuId + ", cpuName=" + cpuName + ", cpuSocket=" + cpuSocket)

    $('#MB').empty().append("<option value = '' series = ''>請選擇一項主機板</option>")
    $('#DRAM').empty().append("<option value = '' series = ''>請選擇一項記憶體</option>")
    $.ajax({
      url: 'http://localhost:8080/products/MB/Filter',
      type: "get",
      data:{"filterI":cpuSocket},
      dataType: "json",
      success: function (data) {
        // console.log(data);
        $.each(data, function (key, value) { // []->{}*?
          $('#MB').append('<option value =" '+data[key].productId+' "series = ' + data[key].series + '>' + data[key].productName + '</option>')
          // console.log(data[key].productId + " " + data[key].productName + " " + data[key].series)
        })
      },
      error: function (data) {
        alert("fail");
      }
    })
  }

  function onSelectMB(){
    var mbId     = $('#MB').find(':selected').val()
    var mbName   = $('#MB').find(':selected').text()
    var mbSeries = $('#MB').find(':selected').attr('series')
    console.log("mbId=" + mbId + ", mbName=" + mbName + ", mbSeries=" + mbSeries)

    $('#DRAM').empty().append("<option value = '' series = ''>請選擇一項記憶體</option>")
    $.ajax({
      url: 'http://localhost:8080/products/DRAM/Filter',
      type: "get",
      data:{"filterI":mbSeries},
      dataType: "json",
      success: function (data) {
        // console.log(data);
        $.each(data, function (key, value) { // []->{}*?
          $('#DRAM').append('<option value =" '+data[key].productId+' "series = ' + data[key].series + '>' + data[key].productName + '</option>')
          // console.log(data[key].productId + " " + data[key].productName + " " + data[key].series)
        })
      },
      error: function (data) {
        alert("fail");
      }
    })
  }


  function onSelectDRAM() {
    var dramId = $('#DRAM').find(':selected').val()
    var dramName = $('#DRAM').find(':selected').text()
    var dramSeries = $('#DRAM').find(':selected').attr('series')
    console.log("dramId=" + dramId + ", dramName=" + dramName + ", dramSeries=" + dramSeries)

    /*
    $.ajax({
      url: 'http://localhost:8080/products/DRAM/Filter',
      type: "get",
      data:{"filter":dramSeries},
      dataType: "json",
      success: function (data) {
        console.log(data);
        $.each(data, function (key, value) { // []->{}*?
        //   $('#DRAM').append('<option value =" '+data[key].productId+' "series = ' + data[key].series + '>' + data[key].productName + '</option>')
          // console.log(data[key].productId + " " + data[key].productName + " " + data[key].series)
        })
      },
      error: function (data) {
        alert("fail");
      }
    })

     */

  }


</script>

<body>
  處理器
  <select id = "CPU" onchange="onSelectCPU()">
    <option value = '' socket = ''>請選擇一項CPU</option>
  </select>
  <br>
  主機板
  <select id = "MB" onchange="onSelectMB()">
    <option value = '' series = ''>請選擇一項主機板</option>
  </select>
  <br>
  記憶體
  <select id = "DRAM" onchange="onSelectDRAM()">
    <option value = "">請選擇一項記憶體</option>
  </select>
</body>
</html>